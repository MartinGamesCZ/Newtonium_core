var{create:P,defineProperty:C,getOwnPropertyDescriptor:T,getOwnPropertyNames:E,getPrototypeOf:_}=Object,z=Object.prototype.hasOwnProperty,R=(g,i)=>()=>(i||g((i={exports:{}}).exports,i),i.exports),D=(g,i)=>{for(var f in i)C(g,f,{get:i[f],enumerable:!0})},p=(g,i,f,b)=>{if(i&&typeof i=="object"||typeof i=="function")for(let d of E(i))!z.call(g,d)&&d!==f&&C(g,d,{get:()=>i[d],enumerable:!(b=T(i,d))||b.enumerable});return g},I=(g,i,f)=>(p(g,i,"default"),f&&p(f,i,"default")),O=(g,i,f)=>(f=g!=null?P(_(g)):{},p(i||!g||!g.__esModule?C(f,"default",{value:g,enumerable:!0}):f,g)),x=R((g,i)=>{function f(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function b(e,t){for(var r="",a=0,o=-1,n=0,c,l=0;l<=e.length;++l){if(l<e.length)c=e.charCodeAt(l);else{if(c===47)break;c=47}if(c===47){if(!(o===l-1||n===1))if(o!==l-1&&n===2){if(r.length<2||a!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){var u=r.lastIndexOf("/");if(u!==r.length-1){u===-1?(r="",a=0):(r=r.slice(0,u),a=r.length-1-r.lastIndexOf("/")),o=l,n=0;continue}}else if(r.length===2||r.length===1){r="",a=0,o=l,n=0;continue}}t&&(r.length>0?r+="/..":r="..",a=2)}else r.length>0?r+="/"+e.slice(o+1,l):r=e.slice(o+1,l),a=l-o-1;o=l,n=0}else c===46&&n!==-1?++n:n=-1}return r}function d(e,t){var r=t.dir||t.root,a=t.base||(t.name||"")+(t.ext||"");return r?r===t.root?r+a:r+e+a:a}var v={resolve:function(){for(var e="",t=!1,r,a=arguments.length-1;a>=-1&&!t;a--){var o;a>=0?o=arguments[a]:(r===void 0&&(r=process.cwd()),o=r),f(o),o.length!==0&&(e=o+"/"+e,t=o.charCodeAt(0)===47)}return e=b(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(f(e),e.length===0)return".";var t=e.charCodeAt(0)===47,r=e.charCodeAt(e.length-1)===47;return e=b(e,!t),e.length===0&&!t&&(e="."),e.length>0&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return f(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];f(r),r.length>0&&(e===void 0?e=r:e+="/"+r)}return e===void 0?".":v.normalize(e)},relative:function(e,t){if(f(e),f(t),e===t||(e=v.resolve(e),t=v.resolve(t),e===t))return"";for(var r=1;r<e.length&&e.charCodeAt(r)===47;++r);for(var a=e.length,o=a-r,n=1;n<t.length&&t.charCodeAt(n)===47;++n);for(var c=t.length,l=c-n,u=o<l?o:l,s=-1,h=0;h<=u;++h){if(h===u){if(l>u){if(t.charCodeAt(n+h)===47)return t.slice(n+h+1);if(h===0)return t.slice(n+h)}else o>u&&(e.charCodeAt(r+h)===47?s=h:h===0&&(s=0));break}var y=e.charCodeAt(r+h),k=t.charCodeAt(n+h);if(y!==k)break;y===47&&(s=h)}var m="";for(h=r+s+1;h<=a;++h)(h===a||e.charCodeAt(h)===47)&&(m.length===0?m+="..":m+="/..");return m.length>0?m+t.slice(n+s):(n+=s,t.charCodeAt(n)===47&&++n,t.slice(n))},_makeLong:function(e){return e},dirname:function(e){if(f(e),e.length===0)return".";for(var t=e.charCodeAt(0),r=t===47,a=-1,o=!0,n=e.length-1;n>=1;--n)if(t=e.charCodeAt(n),t===47){if(!o){a=n;break}}else o=!1;return a===-1?r?"/":".":r&&a===1?"//":e.slice(0,a)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');f(e);var r=0,a=-1,o=!0,n;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var c=t.length-1,l=-1;for(n=e.length-1;n>=0;--n){var u=e.charCodeAt(n);if(u===47){if(!o){r=n+1;break}}else l===-1&&(o=!1,l=n+1),c>=0&&(u===t.charCodeAt(c)?--c===-1&&(a=n):(c=-1,a=l))}return r===a?a=l:a===-1&&(a=e.length),e.slice(r,a)}else{for(n=e.length-1;n>=0;--n)if(e.charCodeAt(n)===47){if(!o){r=n+1;break}}else a===-1&&(o=!1,a=n+1);return a===-1?"":e.slice(r,a)}},extname:function(e){f(e);for(var t=-1,r=0,a=-1,o=!0,n=0,c=e.length-1;c>=0;--c){var l=e.charCodeAt(c);if(l===47){if(!o){r=c+1;break}continue}a===-1&&(o=!1,a=c+1),l===46?t===-1?t=c:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||a===-1||n===0||n===1&&t===a-1&&t===r+1?"":e.slice(t,a)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return d("/",e)},parse:function(e){f(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var r=e.charCodeAt(0),a=r===47,o;a?(t.root="/",o=1):o=0;for(var n=-1,c=0,l=-1,u=!0,s=e.length-1,h=0;s>=o;--s){if(r=e.charCodeAt(s),r===47){if(!u){c=s+1;break}continue}l===-1&&(u=!1,l=s+1),r===46?n===-1?n=s:h!==1&&(h=1):n!==-1&&(h=-1)}return n===-1||l===-1||h===0||h===1&&n===l-1&&n===c+1?l!==-1&&(c===0&&a?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(c,l)):(c===0&&a?(t.name=e.slice(1,n),t.base=e.slice(1,l)):(t.name=e.slice(c,n),t.base=e.slice(c,l)),t.ext=e.slice(n,l)),c>0?t.dir=e.slice(0,c-1):a&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};v.posix=v,i.exports=v}),j={};D(j,{default:()=>A});I(j,O(x()));var A=O(x());class w{id;worker;lib_path=A.join(import.meta.dirname,"lib/libnewtonium"+(process.platform=="win32"?".dll":".so"));constructor(g){this.id=g,this.worker=new Worker(A.join(import.meta.dirname,"worker")),this.worker.onmessage=(i)=>{if(i.data.e=="close"){console.log("Received close message, terminating worker..."),this.worker.terminate();return}},Bun.serve({port:8080,fetch(i,f){f.upgrade(i,{data:{createdAt:Date.now(),channelId:new URL(i.url).searchParams.get("channelId")}})},websocket:{open:(i)=>{console.log("WebSocket connection opened")},close:(i)=>{console.log("WebSocket connection closed")},message:(i,f)=>{if(f=="init~")i.send("new_title")}}})}setCustomBinaryPath(g){return this.lib_path=g,this}open(){this.worker.postMessage({lib_path:this.lib_path,id:this.id})}}export{w as default};
